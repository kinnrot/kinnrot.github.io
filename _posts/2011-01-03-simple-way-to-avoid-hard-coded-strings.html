---
layout: post
title: Simple way to avoid hard coded strings in xaml
date: '2011-01-03T11:20:00.000-08:00'
author: Chen Kinnrot
tags:
- Styles
- Resources
- WPF
modified_time: '2011-01-03T21:32:15.468-08:00'
blogger_id: tag:blogger.com,1999:blog-8908829452516573489.post-8743172493393591478
blogger_orig_url: http://kinnrot.blogspot.com/2011/01/simple-way-to-avoid-hard-coded-strings.html
---

Hard coded strings are annoying,<br />In XAML, we have a lot of cases of hard coded strings.<br /><br />Here is a simple way of implementing static naming class, and use it instead of hard coded strings.<br /><br />Suppose this is my xaml:<br /><br /><pre class="brush: csharp;">&lt;Window x:Class="How.MainWindow"<br />        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"<br />        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"<br />        xmlns:local="clr-namespace:How"<br />        Title="MainWindow" Height="350" Width="525"&gt;<br />    &lt;Window.Resources&gt;<br />        &lt;Style TargetType="{x:Type Button}" x:Key="LazyGuyMeaninglessName"&gt;<br />            &lt;Setter Property="Margin" Value="30"/&gt;<br />            &lt;Setter Property="Height" Value="30"/&gt;<br />            &lt;Setter Property="Width" Value="200"/&gt;<br />        &lt;/Style&gt;<br />    &lt;/Window.Resources&gt;<br />    &lt;StackPanel&gt;<br />            &lt;Button Click="Button_Click"&gt;Click me to activate my style&lt;/Button&gt;<br />        &lt;Button Style="{DynamicResource LazyGuyMeaninglessName}"/&gt;<br />    &lt;/StackPanel&gt;<br />&lt;/Window&gt;<br /><br /></pre><br />This is code behind:<br /><br /><pre class="brush: csharp;">private void Button_Click(object sender, RoutedEventArgs e)<br />{<br />  var button = sender as Button;<br />  if (button != null)<br />  {<br />    button.Style = (Style)this.FindResource("LazyGuyMeaninglessNameWithMistake");<br />  }<br />}<br /></pre><br />I have a mistake in my code behind, and the program will crash, not so fun, and not simple to test this kind of stuff.<br /><br />There is a very simple solution, Lets define this class:<br /><br /><pre class="brush: csharp;">public static class StyleNames<br />{<br />  public static string ButtonStyleName = "Some Hard To write style name";<br />}<br /></pre><br />The benefits of using this class instead of hard coded strings are:<br /><br /><ul><li>No need to avoid long&nbsp;meaningful&nbsp;names, cause you have auto complete built in the IDE.</li><li>The obvious: avoid type mistakes, and unexpected crashes.</li><li>Make your programmers less lazy, they'll be able to change the resource name in a single place, and even his member name if needed, VS will rename it in all references and in XAML(VS 2010)&nbsp;(with a "Ctrl + ." after editing the member name).</li><li>If the style name is not readonly(like in my sample), I'm sure there is a simple way to support theming and dynamic style changing, by just assigning new names for all the resource names inside StyleNames class, and telling the app to do&nbsp;something&nbsp;that will reload all styles, I'm not sure about it, so don't count on it.</li><li>No crashes of "could not find resource bla bla".</li></ul><br />Here is the code after the use of static class:<br /><br /><pre class="brush: csharp;">&lt;Window x:Class="How.MainWindow"<br />    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"<br />    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"<br />    xmlns:local="clr-namespace:How"<br />    Title="MainWindow" Height="350" Width="525"&gt;<br />&lt;Window.Resources&gt;<br />    &lt;Style TargetType="{x:Type Button}" x:Key="{x:Static local:StyleNames.ButtonStyleName}"&gt;<br />        &lt;Setter Property="Margin" Value="30"/&gt;<br />        &lt;Setter Property="Height" Value="30"/&gt;<br />        &lt;Setter Property="Width" Value="200"/&gt;<br />    &lt;/Style&gt;<br />&lt;/Window.Resources&gt;<br />&lt;StackPanel&gt;<br />        &lt;Button Click="Button_Click"&gt;Click me to activate my style&lt;/Button&gt;<br />    &lt;Button Style="{DynamicResource ResourceKey={x:Static local:StyleNames.ButtonStyleName}}"/&gt;<br />&lt;/StackPanel&gt;<br />&lt;/Window&gt;<br /><br />private void Button_Click(object sender, RoutedEventArgs e)<br />{<br />  var button = sender as Button;<br />  if (button != null)<br />  {<br />    button.Style = (Style)this.FindResource(StyleNames.ButtonStyleName);<br />  }<br />}<br /></pre><br />Enjoy :)